(()=>{"use strict";const e={powerUps:[{nombre:"vida",id:"123123"},{nombre:"stoptimer",id:"123123"}],jugador:{nombre:"Alik",vidas:3},niveles:{"nivel-1":{jugado:!1,tiempo:0,estrellas:0},"nivel-2":{jugado:!1,tiempo:0,estrellas:0},"nivel-3":{jugado:!1,tiempo:0,estrellas:0},"nivel-4":{jugado:!1,tiempo:0,estrellas:0},"nivel-5":{jugado:!1,tiempo:0,estrellas:0}}};class t{constructor(){return localStorage.getItem("data")||localStorage.setItem("data",JSON.stringify(e)),t.instance||(t.instance=this),t.instance}#e(){return JSON.parse(localStorage.getItem("data"))}#t(e){localStorage.setItem("data",JSON.stringify(e))}setNombreJugador(e){const t=this.#e();t.jugador.nombre=e,this.#t(t)}getNombreJugador(){return this.#e().jugador.nombre}getVidasJugador(){return this.#e().jugador.vidas}setVidasJugador(e){const t=this.#e();t.jugador.vidas=e,this.#t(t)}getPowerUps(){return this.#e().powerUps}consumirPowerUp(e){const t=this.#e(),s=t.powerUps.filter((t=>t.id!==e));t.powerUps=s,this.#t(t)}pushPowerUp(e){const t=this.#e(),s={nombre:e,id:Date.now().toString()};t.powerUps.push(s),this.#t(t)}setJuegoData(e,t,s,a){const n=this.#e();n.niveles[e].jugado=t,n.niveles[e].tiempo=s,n.niveles[e].estrellas=a,this.#t(n)}getJuegoData(e){return this.#e().niveles[e]}}class s{currentScene=null;constructor(){return s.instance||(s.instance=this),s.instance}async cargarPantalla(e){this.currentScene&&this.currentScene?.onDestroy();const t=document.getElementById("screen"),s=await fetch(`./templates/${e.template}`).then((e=>e.text()));t.innerHTML=s,e.loadLogic(),this.currentScene=e}}class a{dirPath="/build/assets/audio/";audio=null;constructor(e=null){e&&(this.audio=new Audio(this.dirPath+e))}definirBoton(e=new Document){const t=new Audio(this.dirPath+"hit.mp3"),s=new Audio(this.dirPath+"pop.mp3");e.addEventListener("click",(e=>{t.volume=.8,t.play()})),e.addEventListener("mouseenter",(e=>{s.volume=.6,s.play()}))}play(e=.5,t=!1){this.audio&&(this.audio.loop=t,this.audio.volume=e,this.audio.play())}stop(){this.audio&&this.audio.pause()}}function n(e,t=((e=new HTMLElement)=>{})){for(let s=0;s<e.length;s++)t(e[s])}class i{colocarPowerUpsHTML(e,t){e.innerHTML="",t.forEach((t=>{e.innerHTML+=`\n                <div class="power-up" id="${t.id}">\n                    <img src="/build/assets/sprites/power-up-${t.nombre}.png" alt="vida">\n                </div> \n            `}))}colocarVidasHTML(e,t){e.innerHTML="";for(let s=1;s<=t;s++)e.innerHTML+='\n            <div class="vida">\n                <img src="/build/assets/sprites/corazon.gif" alt="vida">\n            </div>\n            '}}function o(e){const t=document.getElementById("screen"),s=document.createElement("div");s.classList.add("modal"),s.innerHTML=`<p class="modal-text">${e}</p>`,t.appendChild(s),setTimeout((()=>{s.remove()}),3e3)}const r={template:"mapa-niveles.html",posNivelesMapa:{"nivel-1":{top:"649px",left:"559px"},"nivel-2":{top:"460px",left:"281px"},"nivel-3":{top:"350px",left:"848px"},"nivel-4":{top:"155px",left:"448px"},"nivel-5":{top:"37px",left:"970px"}},juegosPorNiveles:{"nivel-1":{template:"juego1.html",espacio:12,espacioOcupado:0,intentos:3,baseDatos:null,vidasNumber:null,canasta:null,intentosText:null,espacioText:null,mensajeText:null,frutas:null,powerUpManger:null,reset:function(){this.frutas=document.getElementsByClassName("dragger"),n(this.frutas,(e=>{e.addEventListener("click",(t=>{if(0===this.intentos)return;new a("pop.mp3").play();const s=e.dataset.size;this.canasta.appendChild(e),this.intentos-=1,this.espacioOcupado+=parseInt(s),this.intentosText.innerText="tienes "+this.intentos+" intentos restantes",1===parseInt(s)&&(this.mensajeText.innerText="¡Mandarina!"),2===parseInt(s)&&(this.mensajeText.innerText="¡Zanahoria!"),3===parseInt(s)&&(this.mensajeText.innerText="¡Manzana!"),5===parseInt(s)&&(this.mensajeText.innerText="¡Sandía!");const n=this.espacio-this.espacioOcupado;this.espacioText.innerText="la canasta tiene "+n+" unidades de espacio restantes",0===this.intentos&&(n<0&&(new a("incorrecto.mp3").play(.8),this.vidasNumber-=1,this.baseDatos.setVidasJugador(this.vidasNumber),this.powerUpManger.colocarVidasHTML(vidas,this.vidasNumber),this.mensajeText.innerText="¡Oye te haz pasado!"),this.espacioOcupado<.5*this.espacio&&(new a("incorrecto.mp3").play(.8),this.vidasNumber-=1,this.baseDatos.setVidasJugador(this.vidasNumber),this.powerUpManger.colocarVidasHTML(vidas,this.vidasNumber),this.mensajeText.innerText="¡No utilizaste bien el espacio!"),this.espacioOcupado===this.espacio&&(new a("correcto.mp3").play(.8),this.mensajeText.innerText="¡OH POR DIOS, LO HICISTE PERFECTO!"),this.espacioOcupado>.5*this.espacio&&this.espacioOcupado<this.espacio&&(new a("correcto.mp3").play(.8),this.mensajeText.innerText="¡Oye no estuviste mal!"))}))}))},loadLogic:function(){o("Juego 1");const e=new a("musicaJuego.mp3");e.play(.5,!0),this.baseDatos=new t;const n=document.getElementById("vidas"),l=document.getElementById("powerups");this.canasta=document.getElementById("canasta"),this.vidasNumber=this.baseDatos.getVidasJugador(),this.powerUpManger=new i,this.espacioText=document.getElementById("espacio"),this.mensajeText=document.getElementById("mensaje"),this.intentosText=document.getElementById("intentos");const d=document.getElementById("reset"),c=document.getElementById("contenedorFrutas");this.espacioText.innerText="la canasta tiene "+this.espacio+" unidades de espacio restantes",this.intentosText.innerText="tienes "+this.intentos+" intentos restantes",this.reset(),d.addEventListener("click",(e=>{this.intentos=3,this.espacioOcupado=0,this.canasta.innerHTML="",c.innerHTML='\n<div class="dragger" data-size="1">\n    <img src="/build/assets/sprites/juego1-mandarina.png" alt="item">\n</div>    \n<div class="dragger" data-size="1">\n    <img src="/build/assets/sprites/juego1-mandarina.png" alt="item">\n</div>    \n<div class="dragger" data-size="2">\n    <img src="/build/assets/sprites/juego1-zanahoria.webp" alt="item">\n</div>    \n<div class="dragger" data-size="3">\n    <img src="/build/assets/sprites/juego1-manzana.png" alt="item">\n</div>\n<div class="dragger" data-size="3">\n    <img src="/build/assets/sprites/juego1-manzana.png" alt="item">\n</div>\n<div class="dragger" data-size="5">\n    <img src="/build/assets/sprites/juego1-sandia.png" alt="item">\n</div>\n<div class="dragger" data-size="5">\n    <img src="/build/assets/sprites/juego1-sandia.png" alt="item">\n</div>\n',this.reset()})),document.getElementById("regresar").addEventListener("click",(t=>{e.stop(),(new s).cargarPantalla(r)}));const u=this.baseDatos.getPowerUps();this.powerUpManger.colocarVidasHTML(n,this.vidasNumber),0!==u.length&&this.powerUpManger.colocarPowerUpsHTML(l,u)},onDestroy:function(){}},"nivel-2":{template:"juego2.html",baseDatos:null,vidasNumber:null,loadLogic:function(){o("Juego 2");const e=new a("cupcake.mp3");e.play(.5,!0),this.baseDatos=new t,this.vidasNumber=this.baseDatos.getVidasJugador();const n=document.getElementById("powerups"),l=document.getElementById("vidas"),d=document.getElementById("taller1"),c=document.getElementById("taller2"),u=document.getElementById("taller3");d.addEventListener("click",(e=>{new a("incorrecto.mp3").play(.8),this.vidasNumber-=1,this.baseDatos.setVidasJugador(this.vidasNumber),m.colocarVidasHTML(l,this.vidasNumber)})),c.addEventListener("click",(e=>{new a("incorrecto.mp3").play(.8),this.vidasNumber-=1,this.baseDatos.setVidasJugador(this.vidasNumber),m.colocarVidasHTML(l,this.vidasNumber)})),u.addEventListener("click",(e=>{})),document.getElementById("regresar").addEventListener("click",(t=>{e.stop(),(new s).cargarPantalla(r)}));const p=this.baseDatos.getPowerUps(),m=new i;m.colocarVidasHTML(l,this.vidasNumber),0!==p.length&&m.colocarPowerUpsHTML(n,p)},onDestroy:function(){new a("cupcake.mp3").stop()}},"nivel-3":{template:"juego3.html",loadLogic:function(){},onDestroy:function(){}},"nivel-4":{template:"juego4.html",loadLogic:function(){},onDestroy:function(){}},"nivel-5":{template:"juego5.html",loadLogic:function(){},onDestroy:function(){}}},loadLogic:function(){const e=document.getElementsByClassName("nivel"),o=document.getElementById("datos"),r=document.getElementById("powerups"),l=document.getElementById("vidas"),d=new t,c=new a("mapaMusica.mp3");c.play(.5,!0),n(e,(e=>{(new a).definirBoton(e);const t=e.dataset.nivel,n=e.firstElementChild,i=e.lastElementChild;e.style.top=this.posNivelesMapa[t].top,e.style.left=this.posNivelesMapa[t].left,n.innerText=t.split("-").join(" ");const o=d.getJuegoData(t);o.jugado?(i.style.display="block",i.src=`/build/assets/sprites/nivel-estrellas-${o.estrellas}.jpg`):i.style.display="none",e.addEventListener("click",(e=>{c.stop(),(new s).cargarPantalla(this.juegosPorNiveles[t])}))}));const u=d.getPowerUps(),p=d.getNombreJugador(),m=d.getVidasJugador(),g=new i;g.colocarVidasHTML(l,m),0!==u.length&&g.colocarPowerUpsHTML(r,u),o.innerHTML=`<p><strong>Nombre: </strong>${p}</p>`},onDestroy:function(){}},l={template:"main-menu.html",loadLogic:function(){const e=document.getElementById("play"),i=document.getElementById("botton-entrar"),o=document.getElementById("pedir-nombre"),l=document.getElementsByTagName("button"),d=document.getElementById("input-entrar"),c=new t,u=c.getNombreJugador();o.style.display="none",e.addEventListener("click",(e=>{u?(new s).cargarPantalla(r):(o.style.display="flex",n(l,(e=>{(new a).definirBoton(e)})))})),i.addEventListener("click",(e=>{(d.value||0!==d.value.trim().length)&&(c.setNombreJugador(d.value),(new s).cargarPantalla(r))}))},onDestroy:function(){}};document.addEventListener("selectstart",(e=>{e.preventDefault()})),new t,(new s).cargarPantalla(l)})();